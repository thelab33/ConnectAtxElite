<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ once-per-project CSS helpers (place in globals.css or <style>) -->
<style>
  /* Sweep the foreground arc from 0 % â†’ 100 % based on --pct var (0â€“1) */
  .goal-arc {
    stroke-dasharray: 565.48; /* 2Ï€r, r = 90 */
    stroke-dashoffset: calc(565.48 * (1 - var(--pct, 0)));
    transition: stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* donor ticker */
  @keyframes scroll-ticker {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-50%);
    }
  }
  .scroll-ticker {
    animation: scroll-ticker 22s linear infinite;
  }
</style>

<section
  id="goal-hud"
  class="relative mx-auto my-12 max-w-md text-center"
  role="region"
  aria-labelledby="goal-heading"
  data-goal="{{ goal }}"
  data-raised="{{ raised }}"
>
  <!-- circular gauge -->
  <svg
    viewBox="0 0 200 200"
    aria-hidden="true"
    class="absolute inset-0 h-full w-full"
  >
    <defs>
      <linearGradient id="gauge-gradient" x1="1" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#facc15" />
        <stop offset="100%" stop-color="#4ade80" />
      </linearGradient>
    </defs>
    <!-- background ring -->
    <circle
      cx="100"
      cy="100"
      r="90"
      class="stroke-white/10"
      stroke-width="20"
      fill="none"
    />
    <!-- animated foreground -->
    <circle
      data-goal-arc
      class="goal-arc"
      cx="100"
      cy="100"
      r="90"
      stroke="url(#gauge-gradient)"
      stroke-width="20"
      fill="none"
      transform="rotate(-90 100 100)"
    />
  </svg>

  <!-- headings & live totals -->
  <h2
    id="goal-heading"
    class="mb-1 text-2xl font-extrabold text-amber-400 drop-shadow"
  >
    Season&nbsp;Goal
  </h2>
  <span data-goal-label class="mb-4 block font-mono text-3xl text-green-400">
    $0&nbsp;/&nbsp;${{ goal }}
  </span>

  <!-- linear progress bar (fallback for a11y & JS-off) -->
  <progress
    data-goal-bar
    max="{{ goal }}"
    value="0"
    class="h-5 w-full overflow-hidden rounded-full bg-zinc-800 shadow-inner [--tw-shadow-color:rgba(0,0,0,.3)]"
  ></progress>

  <!-- donor ticker -->
  <div class="mt-5 overflow-hidden text-sm italic text-white/90">
    <div class="inline-block whitespace-nowrap scroll-ticker">
      ðŸš¨ Latest donors: {{ latest_donors|join(', ') }} &nbsp; ðŸš¨ Latest donors:
      {{ latest_donors|join(', ') }}
    </div>
  </div>
</section>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ minimal JS to hook totals & trigger CSS vars (include once) -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const hud = document.getElementById('goal-hud');
    if (!hud) return;

    const goal = +hud.dataset.goal || 1;
    const raised = +hud.dataset.raised || 0;

    /* update numeric label */
    hud.querySelector('[data-goal-label]').textContent =
      `$${raised.toLocaleString()} / $${goal.toLocaleString()}`;

    /* update <progress> bar */
    const bar = hud.querySelector('[data-goal-bar]');
    bar.value = raised;

    /* update circular arc */
    const pct = Math.min(raised / goal, 1);
    hud.style.setProperty('--pct', pct);
  });
</script>
